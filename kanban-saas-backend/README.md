Kanban SaaS API (Laravel)
A Trello‑style, multi‑tenant Kanban backend with teams, projects, boards, columns, cards, comments, attachments, and realtime updates. Designed to be consumed by a React frontend and deployed on Railway + MySQL.

Features
Auth: email/password with token-based auth (Sanctum), email verification, password reset
Multi‑tenant: workspaces/teams with roles (owner/admin/member/guest)
Kanban core: projects → boards → columns (sorted) → cards (sorted)
Collaboration: comments, file attachments (S3/local), activity log
Realtime: optional websockets (Pusher or Laravel WebSockets)
Robust API: versioned routes (/api/v1), validation, policies, rate limiting
Ops: queues for emails/events, health checks, CORS, logging
Tech Stack
PHP 8.2+, Laravel 10/11
MySQL 8 (Railway)
Sanctum, Queues (database or Redis), Mail
Optional: Pusher or Laravel WebSockets; S3/R2 for file storage
Project Structure
text

app/
  ├── Http/Controllers, Middleware, Requests, Resources
  ├── Models (User, Team, TeamMember, Project, Board, Column, Card, Comment, Attachment, Activity)
  ├── Policies, Events, Listeners, Jobs, Notifications, Services
config/
database/
  ├── migrations/
  └── seeders/ (DatabaseSeeder, DemoSeeder)
routes/
  ├── api.php (v1 endpoints)
  ├── channels.php (broadcast auth)
  └── web.php (optional SPA fallback)
public/
tests/
Quick Start
Prerequisites

PHP 8.2+, Composer
MySQL (Railway DB or local)
Node.js (only for your frontend; this repo is API only)
Mail credentials (for password reset/verification)
Optional: Redis (queues/websockets)
Install dependencies
composer install
Configure environment
cp .env.example .env
php artisan key:generate
Set database and CORS (see “Environment” below)

Migrate and seed

php artisan migrate --seed
Run the API
php artisan serve
(Optional) Start a queue worker
php artisan queue:work
Environment
Do NOT commit secrets. Keep .env in gitignore and commit .env.example with placeholders.

Local development (.env)

Use the Railway PUBLIC proxy to reach your DB from your laptop.
text

APP_ENV=local
APP_DEBUG=true
APP_URL=http://127.0.0.1:8000
APP_KEY= # generated by artisan

DB_CONNECTION=mysql
# Option A: split vars
DB_HOST=yamabiko.proxy.rlwy.net
DB_PORT=34647
DB_DATABASE=railway
DB_USERNAME=root
DB_PASSWORD=<XwjrTltniqTYDCLeBEVSoYeoHDBGIilf>
# Option B: single URL (if your database.php supports DATABASE_URL)
# DATABASE_URL=mysql://root:<XwjrTltniqTYDCLeBEVSoYeoHDBGIilf>@yamabiko.proxy.rlwy.net:34647/railway

FRONTEND_ORIGIN=http://localhost:5173
QUEUE_CONNECTION=database
CACHE_DRIVER=file
LOG_CHANNEL=stack
LOG_LEVEL=debug
Production on Railway (Service → Variables)

Use Railway’s INTERNAL host for service‑to‑service networking.
text

APP_ENV=production
APP_DEBUG=false
APP_URL=https://your-api.up.railway.app
APP_KEY=base64:...            # php artisan key:generate --show

DB_CONNECTION=mysql
# Recommended (single URL). Copy your MYSQL_URL value into DATABASE_URL:
DATABASE_URL=mysql://root:<XwjrTltniqTYDCLeBEVSoYeoHDBGIilf>@mysql.railway.internal:3306/railway
# Or split vars:
# DB_HOST=mysql.railway.internal
# DB_PORT=3306
# DB_DATABASE=railway
# DB_USERNAME=root
# DB_PASSWORD=<XwjrTltniqTYDCLeBEVSoYeoHDBGIilf>

FRONTEND_ORIGIN=https://your-frontend.example.com
QUEUE_CONNECTION=database
CACHE_DRIVER=file
LOG_LEVEL=info
TIMEZONE=UTC
Optional env (when needed)

Mail (password reset/verification)
MAIL_MAILER=smtp
MAIL_HOST=…
MAIL_PORT=587
MAIL_USERNAME=…
MAIL_PASSWORD=…
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@yourapp.com
MAIL_FROM_NAME="Kanban"
Realtime (Pusher)
BROADCAST_DRIVER=pusher
PUSHER_APP_ID=…
PUSHER_APP_KEY=…
PUSHER_APP_SECRET=…
PUSHER_HOST= (for self‑hosted)
PUSHER_PORT=
PUSHER_SCHEME=https
Storage (attachments on S3/R2)
FILESYSTEM_DISK=s3
AWS_ACCESS_KEY_ID=…
AWS_SECRET_ACCESS_KEY=…
AWS_DEFAULT_REGION=…
AWS_BUCKET=…
Security note

You shared a real DB password earlier; rotate/regenerate it in Railway (MySQL → Connect tab) if it has been exposed.
API Overview (v1)
Auth

POST /api/v1/auth/register
POST /api/v1/auth/login
POST /api/v1/auth/logout
GET /api/v1/auth/me
POST /api/v1/password/forgot
POST /api/v1/password/reset
POST /api/v1/email/verification-notification
Teams & members

GET /api/v1/teams
POST /api/v1/teams
GET /api/v1/teams/{teamId}
PATCH /api/v1/teams/{teamId}
DELETE /api/v1/teams/{teamId}
POST /api/v1/teams/{teamId}/invite
POST /api/v1/teams/{teamId}/members
DELETE /api/v1/teams/{teamId}/members/{userId}
Projects & boards

GET /api/v1/teams/{teamId}/projects
POST /api/v1/teams/{teamId}/projects
GET /api/v1/projects/{projectId}
PATCH /api/v1/projects/{projectId}
DELETE /api/v1/projects/{projectId}
GET /api/v1/projects/{projectId}/boards
POST /api/v1/projects/{projectId}/boards
PATCH /api/v1/boards/{boardId}
DELETE /api/v1/boards/{boardId}
Columns & cards

GET /api/v1/boards/{boardId}/columns
POST /api/v1/boards/{boardId}/columns
PATCH /api/v1/columns/{columnId}
DELETE /api/v1/columns/{columnId}
GET /api/v1/boards/{boardId}/cards
POST /api/v1/boards/{boardId}/cards
GET /api/v1/cards/{cardId}
PATCH /api/v1/cards/{cardId}
DELETE /api/v1/cards/{cardId}
POST /api/v1/cards/{cardId}/move
POST /api/v1/cards/{cardId}/assign
POST /api/v1/cards/{cardId}/labels
Comments, files, search

GET /api/v1/cards/{cardId}/comments
POST /api/v1/cards/{cardId}/comments
POST /api/v1/cards/{cardId}/attachments
GET /api/v1/attachments/{id} (signed URL)
GET /api/v1/search?query=...&teamId=...
GET /api/v1/health
Notes

All endpoints enforce team scoping and policies; paginate lists; include meta (total, page).
Realtime (optional)
Choose Pusher (managed) or Laravel WebSockets (self‑hosted).
Broadcast board events: card moved/updated, comment added.
Use private/presence channels per board and throttle frequent move events.
Client connects via Echo/Pusher with auth to join board channels.
Files & Storage
Default: local storage; for production use S3/R2 with signed URLs for downloads.
Limit file types/sizes; clean up orphaned files.
Testing
php artisan test
Include Feature tests (auth/boards/cards) and Unit tests (services)
Use a dedicated test database (migrations run in tests)
Deployment (Railway)
Project setup
Create a Railway project
Add a MySQL service (take note of MYSQL_URL and public proxy host/port)
Deploy backend
Deploy from GitHub; set project root to this backend folder (if monorepo)
Attach DB and set variables
Attach your MySQL service to the backend service
Set env vars from the “Production on Railway” block above
Optional: set BROADCAST_DRIVER and PUSHER_* if using realtime
Start command
php artisan migrate --force && php artisan serve --host=0.0.0.0 --port=$PORT
Queue worker (separate service or process)
php artisan queue:work --sleep=1 --tries=3
CORS
FRONTEND_ORIGIN must match your deployed React domain exactly
Optional

Custom domain + SSL, S3 credentials, error tracking (Sentry), Redis + Horizon
Observability
Centralized logs (JSON), error tracking (Sentry), health endpoint (/api/v1/health)
Dev tools: Laravel Telescope (dev only), Horizon (for Redis queues)
Security Checklist
APP_DEBUG=false in production
Rotate DB password if exposed; restrict DB access to internal network in prod
Lock CORS to exact FRONTEND_ORIGIN
Validate every request (Form Requests), use policies/gates for access control
Rate limit auth and write‑heavy endpoints
Backups for DB and storage; define retention
Troubleshooting
SQLSTATE[HY000] [2002]:
Locally: use the PUBLIC proxy host/port (yamabiko.proxy.rlwy.net:34647)
On Railway: use mysql.railway.internal:3306
419/CSRF errors:
Use Sanctum for SPA auth or stick to token‑based auth for APIs
CORS blocked:
Ensure FRONTEND_ORIGIN matches exactly (scheme + domain + port)
Migrations fail:
Check DB credentials and that the user can CREATE/ALTER
License
MIT (or your preferred license)

—